FROM mcr.microsoft.com/dotnet/core/sdk:2.1

RUN ln -s /lib/x86_64-linux-gnu/libdl-2.24.so /lib/x86_64-linux-gnu/libdl.so

RUN echo "deb http://mirrors.aliyun.com/debian stretch main contrib non-free \
          deb http://mirrors.aliyun.com/debian stretch-proposed-updates main contrib non-free \
          deb http://mirrors.aliyun.com/debian stretch-updates main contrib non-free \
          deb http://mirrors.aliyun.com/debian-security/ stretch/updates main non-free contrib" > /etc/apt/sources.list

RUN apt-get update

RUN apt-get install libfontconfig1 -y
RUN apt-get install libgdiplus -y && ln -s libgdiplus.so gdiplus.dll

# wkhtmltopdf
COPY ./wkhtmltopdf/wkhtmltox_0.12.5-1.stretch_amd64.deb /tmp
RUN apt-get install -y fontconfig libfontenc1 libxfont1 x11-common xfonts-75dpi xfonts-base xfonts-encodings xfonts-utils
RUN dpkg -i /tmp/wkhtmltox_0.12.5-1.stretch_amd64.deb
RUN wkhtmltopdf -V

# Fonts
COPY ./fonts/msyhbd.ttc /usr/share/fonts
COPY ./fonts/msyhl.ttc /usr/share/fonts
COPY ./fonts/msyh.ttc /usr/share/fonts
COPY ./fonts/simsunb.ttf /usr/share/fonts
COPY ./fonts/simsun.ttc /usr/share/fonts

